/**
 *
 * Scroll bar´s v. 1.0 
 *
 * @decription: Crea un scroll personalizado con css y con los eventos del mouse.
 * @date : 05/02/2012 - @update 28/08/2012
 * @Create by : Carlos David Vélez Estrada
 * @Email : creacion.paginasweb@hotmail.com
 * @website : http://www.creacionwebamalfi.com/
 * @email : cadavestra@gmail.com
 * All rights reserved - uses free
 *
*/
(function(d){d.scroll_bars=d.scroll_bars||{};d.scroll_bars.defauls={options:{animate:!0,bar_size:!0,hide:!1,wheel:80,speed:200,easing:"easeOutQuart",clase_contenido:".content_div",css_barra:null,css_barrita:null,css_contenido:null,debug:!1,distance:20,event_settings:{latency:1500,mouseover:!0},init:function(){},onTop:function(){},onBottom:function(){},onUpdate:function(){},onScroll:function(){},prop:{}}};d.fn.scroll_bars=function(q){return this.each(function(){var e=d(this),B=d.extend({},d.scroll_bars.defauls.options,
q||{}),a=d.extend({},B,e.data()||{}),c=d(document.createElement("div")).addClass("barra_scroll"),g=d(document.createElement("div")).addClass("barrita_scroll"),j=e.find(a.clase_contenido),C,v=!1,w=!1,u,l,K=!0,m=e.outerHeight(),n=j.outerHeight(!0),p,x=0,r,D=!0,f={},E="undefined"==typeof jQuery.easing[a.easing]?"":a.easing,A=this,F=function(){window.console&&(window.console.log&&!0==a.debug)&&console.log(arguments)},h=function(b,a){if(!isNaN(parseFloat(b)))return a?!0:parseFloat(b);if(a)return!1;F("["+
b+"] No es un n\u00famero.");return!1},M=function(){e.removeData("scroll_settings");e.unbind();c.unbind();d(document).unbind("mousemove.scroll",L).unbind("mouseup.scroll");a._plugins.mousewheel&&!a._plugins.scroll_activity?e.unmousewheel(s):a._plugins.mousewheel&&a._plugins.scroll_activity?e.unbind("mousewheelactivity"):this.removeEventListener?(e[0].removeEventListener("DOMMouseScroll",s,!1),e[0].removeEventListener("mousewheel",s,!1)):e[0].onmousewheel=null;e.find(".barra_scroll").remove()},G=function(){(C=
n>m)?c.stop(!0,!0).fadeIn("slow"):c.stop(!0,!0).fadeOut("slow")},H=function(){!0==D&&!g.data("evt_org")?c.stop(!0,!0).fadeOut("fast"):c.stop().show()},s=function(b,y,S,d,c){e.stop(!0,!1);g.stop(!0,!1);if(j.outerHeight()<=e.outerHeight())return!1;b=c?b:b||window.event;y=c?y:b.wheelDelta?b.wheelDelta/120:-b.detail/3;D=!0;b.preventDefault?b.preventDefault():b.returnValue=!1;x=0<x+y*a.wheel?0:x+y*a.wheel;y=0<x?-1*a.wheel:x;z("onScroll",b);return f=t(-1*y)},J=function(b){try{b.preventDefault?b.preventDefault():
b.returnValue&&(b.returnValue=!1),b.stopImmediatePropagation()}catch(a){}b.offset=g.offset();b.top="auto"==g.css("top")?0:h(g.css("top"));g.data("evt_org",b);d(document).bind("mousemove.scroll",L);D=!1},L=function(b){b.preventDefault();var a=g.data("evt_org");b.startX=a.pageX;b.startY=a.pageY;b.deltaX=b.pageX-a.pageX;b.deltaY=b.pageY-a.pageY;b.originalX=a.offset.left;b.originalY=a.offset.top;b.offsetX=b.originalX+b.deltaX;b.offsetY=b.originalY+b.deltaY;b.top=a.top;b=b.startY-(b.pageY+b.top);return f=
t(-1*(0>b?b:0)*r,!0)},O=function(b){b.preventDefault();u=b.pageY;b=u-c.offset().top;l-b<p&&b>p?b-=p:b>p&&(b-=p/2);return f=t(b*r)},P=function(){if(!e.is(":visible")||!j.is(":visible"))return!1;var b="auto"==j.css("top")?0:h(j.css("top"));m=e.outerHeight();n=j.outerHeight(!0);l=h(a.bar_size,!0)?h(a.bar_size):m;c.setOuterHeight(l);l=c.height();r=n/l;C=n>m;g.setOuterHeight(l/r,!1,!0);p=g.data("_outerHeight");g.stop().animate({height:p+"px"},{duration:a.speed,easing:E,queue:!1});a.prop.height={wrap_scroll:m,
warp_content:n,barra:l,barrita:p,factor:r};0<b||n<=m?(b=0,c.fadeOut(0)):(c.fadeIn(0),b=-1*b+0.001);f=t(b);z("onUpdate")},Q=function(){I({},"0%")},R=function(){I({},"100%")},N=function(b,a){var e=(b+"").charAt(0);return"+"==e?h(a)+h(b):"-"==e?-1*h(a)-h(b):!1},t=function(b,e){var c="auto"==j.css("top")?0:-1*h(j.css("top")),d=n-m,k=N(b,c),k=k?0>k?-1*k:k:h(b);f.warp=null;f.barra=null;f._function="";f.move=!1;f.percent=null;d=Math.max(0,d);k=Math.min(d,Math.max(k,0));a.distance*r>k?(f._function="onTop",
w=!1):k>=d-a.distance*r?(f._function="onBottom",v=!1):w=v=!1;f.move=k!==c;f.barra=k/r;f.warp=x=-1*k;f.move&&(f.percent=100*k/(n-m),G(),c=f.warp,d=f.barra,k="",k=void 0!=k?k:void 0!=k?k:"",!0==a.animate&&"undefined"==typeof e?(h(c,!0)&&j.animate({top:c+"px"},{duration:a.speed,easing:E,queue:!1}),h(d,!0)&&g.animate({top:d+"px"},{duration:a.speed,easing:E,queue:!1})):(h(c,!0)&&j.css({top:c+"px"}),h(d,!0)&&g.css({top:d+"px"})),z(k),"onTop"==f._function&&!1==v?(z(f._function),v=!0):"onBottom"==f._function&&
!1==w&&(z(f._function),w=!0),a.prop.poss=f);return f},I=function(b,a){if(j.outerHeight()<=e.outerHeight())return!1;var c="auto"==j.css("top")?1:-1*h(j.css("top"));if("string"===d.type(a)&&"%"==a.charAt(a.length-1)){var g=h(a),c=(c=N(a,100*c/(n-m)))?Math.min(100,Math.max(0,0>c?-1*c:c)):g;f=t(c*(n-m)/100)}else h(a,!0)?f=t(a):j.find(a)&&0<j.find(a).length&&(g=j.find(a).offset().top-j.offset().top,f=t(g-10))},z=function(b,f){var h=[{wrap_scroll:e.get(0),warp_content:j.get(0),barra:c.get(0),barrita:g.get(0)},
a,b],q=!0==a.animate?a.speed:0;switch(b){case "init":d.isFunction(a.init)&&K&&(a.init.apply(A,h),K=!1);break;case "onTop":d.isFunction(a.onTop)&&!1==v&&setTimeout(function(){a.onTop.apply(A,h)},q);v=!0;break;case "onBottom":d.isFunction(a.onBottom)&&!1==w&&setTimeout(function(){a.onBottom.apply(A,h)},q);w=!0;break;case "onUpdate":d.isFunction(a.onUpdate)&&setTimeout(function(){a.onUpdate.apply(A,h)},q);break;case "onScroll":d.isFunction(a.onScroll)&&(h.unshift(f),a.onScroll.apply(A,h))}return b};
e.data("scroll_settings")&&M();a._plugins={scroll_activity:!!jQuery.event.special.mousewheelactivity,mousewheel:!!jQuery.event.special.mousewheel};e.prepend(c.append(g));l=h(a.bar_size,!0)?h(a.bar_size):m;c.setOuterHeight(l);l=c.height();r=n/l;C=n>m;p=l/r;g.setOuterHeight(p);p=g.height();g.css("top","0px");c.css("top","-1px");a.prop.height={wrap_scroll:m,warp_content:n,barra:l,barrita:p,factor:r};C||c.fadeOut(0);e.css("position","relative");j.css("position","relative");"object"==typeof a.css_barra&&
c.css(a.css_barra);"object"==typeof a.css_barrita&&g.css(a.css_barrita);"object"==typeof a.css_contenido&&j.css(a.css_contenido);(function(){function b(b,c,d,e,f){switch(c){case "mousewheel":s(b,d,e,f,!0);break;case "start":case "stop":if(!0==a.hide){try{b.preventDefault?b.preventDefault():b.returnValue&&(b.returnValue=!1)}catch(g){}"start"==c?G():H()}}}F(!a._plugins.mousewheel?'The file "jquery.mousewheel.min.js" was not found.':'$.scroll_bars working with "jquery.mousewheel.min.js"');a._plugins.mousewheel&&
!a._plugins.scroll_activity?e.mousewheel(s):a._plugins.mousewheel&&a._plugins.scroll_activity?(e.bind("mousewheelactivity",a.event_settings,b),!0==a.hide?H():""):this.addEventListener?(e[0].addEventListener("DOMMouseScroll",s,!1),e[0].addEventListener("mousewheel",s,!1)):e[0].onmousewheel=s;c.bind("mousedown.scroll",O);g.bind("mousedown",J);e.bind({scroll_update:P,gototop:Q,gotobottom:R,scroll_remove:M,scroll_goto:I});!0==a.hide&&(a._plugins.scroll_activity||e.hover(G,H).trigger("mouseout"),F(!a._plugins.scroll_activity?
'The file "mousewheel_activity.min.js" was not found.':'$.scroll_bars working with "mousewheel_activity.min.js"'));d(document).bind("mouseup.scroll",function(a){try{a.preventDefault?a.preventDefault():a.returnValue&&(a.returnValue=!1)}catch(b){}g.removeData("evt_org");D=!0;d(document).unbind("mousemove.scroll")})})();e.data("scroll_settings",a);z("init");return e})};var u=[],J=Object.prototype.toString,B="Boolean Number String Function Array Date RegExp Object".split(" ");d.each(B,function(d){u["[object "+
B[d]+"]"]=(B[d]+"").toLowerCase()});d.type=d.type||function(d){return null==d?String(d):u[J.call(d)]||"object"};d.fn.setOuterHeight=function(q,e,u){if(!this||0==this.length||isNaN(parseFloat(q)))return this;q=parseFloat(q);return this.each(function(){var a=d(this),c=0,g,j=["border-top-width","padding-top","padding-bottom","border-bottom-width"];!0===e&&j.push("margin-top","margin-bottom");d.each(j,function(d,e){g=a.css(e);c+=!isNaN(parseFloat(g))?parseFloat(g):0});c=0>=q-c?0:q-c;u?a.data("_outerHeight",c):a.height(c)})}})(jQuery);